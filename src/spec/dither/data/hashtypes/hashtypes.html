<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>hashtypes</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="/style.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="idea-document-for-hashtypes">Idea Document for Hashtypes</h1>
<h2 id="what-is-a-hashtype">What is a Hashtype</h2>
<p>Generally, A hashtype is a piece of data, prepended by a Multihash. The multihash can be resolved using <a href="../../routing/directional-trail-search.html">directional-trail-search</a> to some data that defines the layout of the hashtype.</p>
<p>A type definition (seen below) contains a type name, multiple fields, and a type for each field. The most primitive type definition (<code>Layout</code>) allows for the creation of dependent types.</p>
<h2 id="what-constitutes-a-layout">What constitutes a Layout?</h2>
<p>All Types are all eventually defined by the core <code>Layout</code> type.</p>
<p>The core <code>Layout</code> type is defined <strong>in implementation</strong> roughly as:</p>
<p><code>Layout</code> - num_fields: <code>B8</code> - Binary 8-bit number - num_traits: <code>B8</code> - hash_length: <code>VarUInt</code> - Variable unsigned integer - hash_type: <code>VarUInt</code> - fields: <code>Unknown</code> - Variable length data - traits: <code>Unknown</code> - <code>$FixedSize = undefined</code> - It doesn’t matter what this is because <code>$Size</code> doesn’t use it for this type. - <code>$Size: $FixedSize = (self) -&gt; U64</code> - <code>num_fields.size() + hash_length.size() + hash_type.size() + num_fields.to_u64() * hash_length.to_u64()</code> - Defined as function that takes a reference to the beginning of a buffer containing a value of type Layout and returns 64-bit integer. - Depends on <code>$FixedSize</code>. Fixed-size types return <code>$FixedSize</code>. Variable-length types calculate size dynamically. - <code>$Correct: $Size = (self, size) -&gt; bool</code> - <code>(size == $Size(self)) &amp; num_fields.correct() &amp; hash_length.correct() &amp; hash_type.correct()</code> - Dependent Trait, relies on <code>$Size</code>. Returns true if <code>Unknown</code> data field is correct size and the <code>VarUInt</code>s are also correctly formatted. - <code>$Valid: $Correct = (self, size) -&gt; bool</code> - <code>{ $Correct(self, size) &amp; num_fields.valid() &amp; hash_length.valid() &amp; hash_type.valid() &amp; [logic to verify hash-linked objects validity contained in data field] }</code></p>
<p>See <a href="#traits">Traits</a> for an explanation of <code>$</code> notation.</p>
<p>This also infers the interpretation of <code>VarUInt</code> and <code>Unknown</code>.</p>
<p><code>VarUInt</code> - A VarUInt is just a Variable Unsigned Integer - data: <code>Unknown</code> - <code>$Size: $FixedSize = (self) -&gt; U64: [varint size algorithm]</code> - <code>$Correct: $Size = (self, size) -&gt; bool</code></p>
<p>The <code>Unknown</code> type just refers to raw data that is defined via the <code>$Size</code> and <code>$Correct</code> Traits.</p>
<h2 id="traits">Traits</h2>
<p>Traits define programs or adjacent data on Types. They are themselves Hashtypes linked directly from the layout type or via <a href="../reverse-hash-lookup.html">reverse linked data</a>.</p>
<table>
<thead>
<tr class="header">
<th>Trait: Layout` - A Trait is a type that defines multiple functions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>- <code>$Size: $FixedSize = (self) -&gt; U64: type.size()</code></td>
</tr>
<tr class="even">
<td>- <code>$Correct: $Size = (self, size) -&gt; U64</code></td>
</tr>
</tbody>
</table>
<p><code>LinkedTrait</code> - Trait that is reverse-linked</p>
<p><code>Function</code> - A program is an input and an output - input: <code>Multihash</code> - output: <code>Multihash</code></p>
<p><code>Implementation</code> - Implementation of a program - program: <code>Multihash</code> - Program Layout Multihash - type: <code>VarUInt</code> - Program Type (CPU Arch) - impl: <code>Unknown</code> - Program Data (Machine Code)</p>
<p>All types should have the <code>$Correct</code> trait definitions (This implies <code>$Size</code> and <code>$FixedSize</code>)</p>
<p><code>$Size</code> is described as a <code>U64</code> or <code>Reference -&gt; U64</code>.</p>
<p><code>$Correct</code> takes a reference to a point in memory where a Typed value is and returns true if the</p>
</body>
</html>
